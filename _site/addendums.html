<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta name="author" content="laufeynumber1fan" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/addendums.html" />
<meta property="og:url" content="http://localhost:4000/addendums.html" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"laufeynumber1fan"},"url":"http://localhost:4000/addendums.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/"></a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/resources.html">Resources</a><a class="page-link" href="/tool-journal.html">Tools</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <style>
  .page-content > .wrapper {
  width: 50%;
  max-width: none;
  overflow:visible;
  }
</style>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Unsorted snippets for general tips. Most of these have been linked from other files.
</code></pre></div></div>

<h2 id="21">2&gt;&amp;1</h2>
<p>In bash, there is something called <code class="language-plaintext highlighter-rouge">stdout</code>, <code class="language-plaintext highlighter-rouge">stderr</code>, and <code class="language-plaintext highlighter-rouge">stdin</code> (std means ‘Standard’).</p>

<p><code class="language-plaintext highlighter-rouge">stdin</code> is for user input and is irrelevant in this note, however <code class="language-plaintext highlighter-rouge">2&gt;&amp;1</code> means output (&amp;1) and errors (&amp;2) are combined into the same output.</p>

<p>Usual behavior from commands <ins>will</ins> output <code class="language-plaintext highlighter-rouge">stdout</code> and <code class="language-plaintext highlighter-rouge">stderr</code> in the same shell, but in cases of exceptions, <code class="language-plaintext highlighter-rouge">2&gt;&amp;1</code> can be used to display errors on the shell.</p>

<p>P.S: <code class="language-plaintext highlighter-rouge">2&gt;</code> is used to direct errors.</p>

<h2 id="about-drive-partitioning-in-linux">About <a href="https://en.wikipedia.org/wiki/Disk_partitioning#Unix-like_systems">drive partitioning</a> in Linux.</h2>
<blockquote>
  <p>A common minimal configuration for Linux systems is to use three partitions: one holding the system files mounted on “/” (the root directory), one holding user configuration files and data mounted on /home (home directory), and a swap partition.</p>
</blockquote>

<blockquote>
  <p>When a partition is deleted, its entry is removed from a table and the data is no longer accessible. The data remains on the disk until it is overwritten.</p>
</blockquote>

<h2 id="from-an-ubuntu-article">From an <a href="https://help.ubuntu.com/community/HowtoPartition/OperatingSystemsAndPartitions">Ubuntu article</a></h2>
<blockquote>
  <p>…when shrinking a partition, you should leave some free space to reduce the likelyhood of fragmentation and make it easier to defragment. Fragmented files will cause your computer to run slower and increase the possibility of file corruption.
A rule of thumb is to keep at least 10% of the partition as free space. Personally, I like at least 25%.</p>
</blockquote>

<h2 id="concerning-partitioning-and-disk-drives">Concerning partitioning and <a href="https://en.wikipedia.org/wiki/Hard_disk_drive#Formatting">disk drives</a></h2>
<p>It is important align the partitions of disks by the start and end of logical blocks. It would be very ineffecient and error-prone for a partition to appear during a middle of a logical block.</p>
<blockquote>
  <p>Data is stored on a hard drive in a series of logical blocks. Each block is delimited by markers identifying its start and end . . . These blocks often contained 512 bytes of usable data, but other sizes have been used.</p>
</blockquote>

<p>Partitioning should be done in KiB, MiB, and GiB because HDD logical blocks are 512 bytes/block. For example, 1024 KiB is (2^10) * 1024 -&gt; 1048576 bytes -&gt; 2048 blocks. Refer to <a href="https://www.techtarget.com/rms/onlineimages/storage-hc_exbibyte_multiples_bytes.png">table</a>.</p>

<h2 id="resizing-partitions-on-vmware">Resizing partitions on VMware</h2>
<p><code class="language-plaintext highlighter-rouge">parted /example/drivename</code> go into the full drive
<code class="language-plaintext highlighter-rouge">print free</code> find the number
<code class="language-plaintext highlighter-rouge">resizepart X 100GiB</code> X for partition number and the new end of partition
<code class="language-plaintext highlighter-rouge">quit</code> to get out parted</p>

<p>You’ll resize the actual partition but the filesystem will retain it’s original size.
Do <code class="language-plaintext highlighter-rouge">df -h</code> + <code class="language-plaintext highlighter-rouge">fdisk -l</code> and you can compare the different partition sizes. It will be different.
<code class="language-plaintext highlighter-rouge">resize2fs /example/drivename</code> to sync the size of file system to the new partition size.</p>

<h2 id="find-all-unique-ips-in-a-zeek-connlog">Find all unique IPs in a zeek conn.log</h2>

<p><code class="language-plaintext highlighter-rouge">cat conn.log | zeek-cut id.orig_h id.resp_h | tr '\t' '\n' | sort | uniq | wc -l</code>
Why use <code class="language-plaintext highlighter-rouge">tr '\t' '\n'</code> (replace all \t with \n)?</p>

<p>When doing <code class="language-plaintext highlighter-rouge">cat conn.log | zeek-cut id.orig_h id.resp_h</code> you get this output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.2.8.101      23.198.7.167
10.2.8.101      104.129.55.103
10.2.8.101      104.129.55.103
10.2.8.101      40.126.28.21
10.2.8.101      10.2.8.1
</code></pre></div></div>
<p>By replacing all tabs with newlines the new output will look like:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10.2.8.101
23.198.7.167
10.2.8.101
104.129.55.103
10.2.8.101
104.129.55.103
</code></pre></div></div>
<p>This makes it much easier to do <code class="language-plaintext highlighter-rouge">sort | uniq | wc -l</code></p>

<h2 id="generate-zeek-logs-in-json-format"><a href="https://docs.zeek.org/en/master/log-formats.html#zeek-json-format-logs">Generate zeek logs in JSON format</a></h2>
<p><code class="language-plaintext highlighter-rouge">zeek -C -r foo.pcap LogAscii::use_json=T</code><br />
Make a separate dir for these json logs. This is useful for pretty printing zeek logs with <code class="language-plaintext highlighter-rouge">jq</code> or with firefox pretty print.<br />
<code class="language-plaintext highlighter-rouge">zeek-cut</code> is no longer usable. Use <code class="language-plaintext highlighter-rouge">jq</code>, for ex. <code class="language-plaintext highlighter-rouge">jq -c '[."id.orig_h", ."query", ."answers"]' dns.log</code> (see <a href="https://docs.zeek.org/en/master/log-formats.html#zeek-json-format-and-jq">zeek doc</a> &amp; <a href="https://stedolan.github.io/jq/manual/">jq manual</a>)</p>

<h2 id="proper-way-to-report-malicious-urls">Proper way to report malicious URLs</h2>
<p>BAD | GOOD
— | —
<a href="https://www.youtube.com/watch?v=c8tGgVX9__Q">dontclickthiswebsite.com</a> | dontclickthiswebsite[.]com</p>

<p>Official term is defanging. This is to prevent browsers and text editors from automatically making links to URLs or to stop people from acidentally clicking the link</p>

<h2 id="give-tshark-a-gui-by-putting-pcaps-into-a-web-browser">Give tshark a GUI by putting pcaps into a web browser</h2>

<p>Step 1: Carve out a small portion of the pcap, use <code class="language-plaintext highlighter-rouge">-Y</code> to write out a display filter, <code class="language-plaintext highlighter-rouge">-V</code> to verbosely output the packet, <code class="language-plaintext highlighter-rouge">-T</code> to convert to Packet Display Markup Language (pdml)<br />
<code class="language-plaintext highlighter-rouge">tshark -r foo.pcap -Y "tcp.stream eq 0" -V -T pdml &gt; test.xml</code></p>

<p>Step 2: convert the xml file into html with xsltproc this is a tool that applies xml styling.</p>

<p>Wireshark already has this stylesheet preinstalled to convert pdml + xml files into html, so you’re looking for the file <code class="language-plaintext highlighter-rouge">pdml2html.xsl</code><br />
In kali it’s <code class="language-plaintext highlighter-rouge">/usr/share/doc/wireshark/pdml2html.xsl.gz</code>. It’s a gz file so you want to get into that directory and use <code class="language-plaintext highlighter-rouge">gunzip pdml2html.xsl.gz</code> to decompress it.</p>

<p>Go back to your working dir, the full command is then:<br />
<code class="language-plaintext highlighter-rouge">xsltproc /usr/share/doc/wireshark/pdml2html.xsl test.xml &gt; test.html</code></p>

<p>Step 3: open the html into firefox
<code class="language-plaintext highlighter-rouge">firefox test.html</code><br />
Now your shit has a drop down menu for packets, kinda like wireshark</p>

<h2 id="trace-ps-command-history">Trace PS command history</h2>
<p><code class="language-plaintext highlighter-rouge">Get-Content (Get-PSReadlineOption).HistorySavePath</code>
Useful for seeing if bad scripts had been running</p>

<h2 id="installing-zeek">Installing zeek</h2>
<p>Run these commands:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo 'deb http://download.opensuse.org/repositories/security:/zeek/xUbuntu_24.10/ /' | sudo tee /etc/apt/sources.list.d/security:zeek.list
curl -fsSL https://download.opensuse.org/repositories/security:zeek/xUbuntu_24.10/Release.key | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/security_zeek.gpg &gt; /dev/null
sudo apt update
sudo apt install zeek
</code></pre></div></div>
<p>Then set the path variable:<br />
<code class="language-plaintext highlighter-rouge">export PATH=/usr/local/zeek/bin:$PATH</code>
or zeek might have been installed in /opt
<code class="language-plaintext highlighter-rouge">export PATH=/opt/zeek/bin:$PATH</code></p>

<p>If zeek is not working or the terminal is frozen, you may need to do <code class="language-plaintext highlighter-rouge">apt upgrade</code> to update zeek or zeek dependencies to the most recent distro version.</p>

<h2 id="signing-new-gpg-keys">Signing new gpg keys.</h2>
<p>So all kali VMs needed a new gpg key because of this kali <a href="https://www.kali.org/blog/new-kali-archive-signing-key/">blog</a> and this led me to this rabbit hole about how gpg is used to verify the safe installation of apt packages and preventing malicious URLs from providing the downloads.</p>

<p>Here’s some of the stuff I read.
<a href="https://askubuntu.com/questions/1286545/what-commands-exactly-should-replace-the-deprecated-apt-key/1307181#1307181">You need to know why apt-key add is deprecated</a><br />
<a href="https://gnupg.org">Official doc</a><br />
<a href="https://wiki.archlinux.org/title/GnuPG">Arch wiki tutorial</a></p>

<p>It’s very easy to assume thatgpg is like adding TLS to file transfers, they achieve the same thing but achieve it differently. The difference is that TLS encrypts the connection but gpg encrypts the file itself and verifies that it is the correct package from the source repository.</p>

<h2 id="how-to-make-aliases-permanent-in-bash-or-zsh">How to make aliases permanent in bash or zsh</h2>
<p>Edit the file ~/.bash_aliases</p>

<p>Add a new <code class="language-plaintext highlighter-rouge">alias</code> command, for example <code class="language-plaintext highlighter-rouge">alias ll='ls -l</code>
Save the txt file and run <code class="language-plaintext highlighter-rouge">source ~/.bash_aliases</code>. 
Verify by running the command <code class="language-plaintext highlighter-rouge">alias</code> without args.</p>

<p>For zsh, just do <code class="language-plaintext highlighter-rouge">echo "alias ll='ls -l'" &gt;&gt; ~/.zshrc</code> then <code class="language-plaintext highlighter-rouge">source ~/.zshrc</code></p>

<p>This is the same method for other commands like <code class="language-plaintext highlighter-rouge">export</code> which can make path variables permanent.
<code class="language-plaintext highlighter-rouge">echo "export PATH=/opt/zeek/bin:$PATH" &gt;&gt; ~/.zshrc</code><br />
<code class="language-plaintext highlighter-rouge">source ~/.zshrc</code></p>

<h2 id="interactive-awk-exercises">Interactive awk exercises</h2>
<p>The author of this <a href="https://learnbyexample.github.io/learn_gnuawk/preface.html">awk tutorial blog</a> made an interactive tool for the blog’s exercises.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -m venv textual_apps
cd textual_apps
source bin/activate
pip install awkexercises
awkexercises
</code></pre></div></div>
<p>Github of the tool <a href="https://github.com/learnbyexample/TUI-apps/tree/main/AwkExercises">here</a></p>

<h2 id="executing-a-command-on-a-remote-machine-using-ssh-without-getting-a-shell">Executing a command on a remote machine using SSH without getting a shell</h2>
<p>For any reason that you want to remotely access a machine without getting a shell you can simply add the command you want to execute after the ssh command.<br />
<code class="language-plaintext highlighter-rouge">ssh foouser@localhost -p 9999 cat ./data.txt</code></p>

<p>This was useful to learn when I did overtiewire’s <a href="https://overthewire.org/wargames/bandit/bandit19.html">bandit level 18 -&gt; 19</a> where the user’s .bashrc logs clients out upon connection.</p>

<h2 id="digest-big-pcaps">Digest big pcaps</h2>
<p><code class="language-plaintext highlighter-rouge">tshark</code> has limitations with 1GB+ pcaps which is when other tools like <code class="language-plaintext highlighter-rouge">tcpdump</code> and <code class="language-plaintext highlighter-rouge">editcap</code> plays a role in pcap analysis. tshark <ins>can</ins> still parse large pcaps but may take 1 min+ for every command as it is a more robust tool.</p>

<p>Method 1: Split into multiple files
<code class="language-plaintext highlighter-rouge">tcpdump -r big.pcap -C 1000 -w small.pcap</code>
If, for example, <code class="language-plaintext highlighter-rouge">big.pcap</code> is 3GB big, tcpdump’s -C (file size) flag may be used to carve <code class="language-plaintext highlighter-rouge">big.pcap</code> into 1GB pcaps.<br />
The output of this command will generate <code class="language-plaintext highlighter-rouge">small.pcap</code> <code class="language-plaintext highlighter-rouge">small.pcap1</code> <code class="language-plaintext highlighter-rouge">small.pcap2</code><br />
If you’re looking for a specific TCP stream or conversation, the entire connection will most likely be captured in a 1GB pcap slice. It’s also palatable enough to open the slice on wireshark!</p>

<h2 id="simple-backdoor-with-ncat">Simple backdoor with ncat</h2>
<p>(Note: Discovered this in <a href="https://linuxzoo.net/page/lab_kali2024-4/wk01c.html#frm_17">linuxzoo.net’s kali room</a>)</p>

<p>You can create a simple backdoor with <a href="https://laufeynumber1fan.github.io/tool-journal.html#ncat">ncat</a> by executing a bash shell upon connecting to a <code class="language-plaintext highlighter-rouge">ncat</code> session:</p>

<p><code class="language-plaintext highlighter-rouge">ncat -l localhost 7890 -c '/bin/bash' -k</code><br />
<code class="language-plaintext highlighter-rouge">-l</code> Make port 7890 to listen for ncat connections.<br />
<code class="language-plaintext highlighter-rouge">-c</code> Run a bash shell upon connection.<br />
<code class="language-plaintext highlighter-rouge">-k</code> Allow multiple connections (in this case shells).</p>

<h2 id="-z-in-ncat-vs-nc">-z in ncat vs nc</h2>
<p><a href="laufeynumber1fan.github.io/tool-journal.html#ncat">ncat</a> is the child of its parent <a href="laufeynumber1fan.github.io/tool-journal.html#nc">nc</a>, so why is there <code class="language-plaintext highlighter-rouge">-z</code> (port scanning) in <code class="language-plaintext highlighter-rouge">nc</code> but no port scanning in <code class="language-plaintext highlighter-rouge">ncat</code>.</p>

<p><code class="language-plaintext highlighter-rouge">ncat</code> is packaged with nmap so when making the successor the <code class="language-plaintext highlighter-rouge">nc</code>, the nmap developers removed <code class="language-plaintext highlighter-rouge">ncat</code>’s <code class="language-plaintext highlighter-rouge">-z</code> feature because port scanning usage should be in <code class="language-plaintext highlighter-rouge">nmap</code> itself.</p>

<p>That is why the older <code class="language-plaintext highlighter-rouge">nc</code> tool still has port scanning features albeit less developed than nmap.</p>

<p><code class="language-plaintext highlighter-rouge">nc -zv [HOST] [1-9999]</code></p>

<h2 id="basic-nmap-scripting">Basic nmap scripting</h2>
<p>3 basic steps:</p>

<ol>
  <li>
    <p>Search for a script to use in nmap’s <code class="language-plaintext highlighter-rouge">script.db</code><br />
<code class="language-plaintext highlighter-rouge">cat /usr/share/nmap/scripts/script.db | grep dns</code></p>
  </li>
  <li>
    <p>Get info on the script.<br />
<code class="language-plaintext highlighter-rouge">nmap --script-help dns-zone-transfer</code></p>
  </li>
  <li>
    <p>Run it.<br />
<code class="language-plaintext highlighter-rouge">nmap &lt;options&gt; &lt;target&gt; --script dns-zone-transfer</code></p>
  </li>
</ol>

<p>To use all non-invasive nmap scripts, use <code class="language-plaintext highlighter-rouge">-sC</code>.</p>

<h2 id="less-not-working">less not working</h2>
<p>If <code class="language-plaintext highlighter-rouge">less</code> is not showing anything and the whole screen is just <code class="language-plaintext highlighter-rouge">~</code> then that means the piped command may have outputted to <code class="language-plaintext highlighter-rouge">stderr</code> and not <code class="language-plaintext highlighter-rouge">stdout</code>.</p>

<p>For example, the command <code class="language-plaintext highlighter-rouge">tshark -z help</code> displays the help command for <code class="language-plaintext highlighter-rouge">-z</code> but the help info is considered an error message. When you pipe this command to <code class="language-plaintext highlighter-rouge">less</code> nothing gets displayed. 
Do <code class="language-plaintext highlighter-rouge">2&gt;&amp;1</code> to change the console <code class="language-plaintext highlighter-rouge">std</code> to <code class="language-plaintext highlighter-rouge">out</code> and not <code class="language-plaintext highlighter-rouge">err</code>.<br />
<code class="language-plaintext highlighter-rouge">tshark -z help 2&gt;&amp;1 | less</code></p>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"></h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot; =&gt; &quot;laufeynumber1fan&quot;}</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
